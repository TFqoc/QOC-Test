<odoo>
    <data>
        <record model="ir.ui.view" id="qoc_sales_order_delivery_schedule.qweb">
            <field name="name">Sales Order Delivery Schedule qweb</field>
            <field name="model">sale.order</field>
            <field name="arch" type="xml">
              <qweb>
                <script>
                  function toggle_dropdown(el){
                    var target = el.parentElement.parentElement.nextElementSibling;
                    if (target.style.display == ''){
                      target.style.display = 'none';
                      el.className = 'fa fa-caret-right dropdown-content';
                    }
                    else{
                      target.style.display = '';
                      el.className = 'fa fa-caret-down dropdown-content';
                    }
                  }
                  function get_mo_data(el){
                    id = el.getAttribute("model_id");
                    $.ajax({
                        url: "/qoc_sales_order_delivery_schedule/qoc_sales_order_delivery_schedule/objects/${id}",
                        data: {
                          zipcode: 97201
                        },
                        success: function( result ) {
                          $( "#box_2" ).html( "<strong>" + result + "</strong>" );
                        }
                      });
                }
                </script>
                <style>
                  .ds_card{
                    border: 2px solid #ced4da;
                    min-width: 150px;
                    background-color: #ffffff;
                    margin: 4px;
                    padding: 4px;
                }
                </style>
                <div class="container">
                  <div class="row justify-content-around mb-5">
                    <!-- Box 1 -->
                    <div class="col">
                      <div class="o_list_view ds_card" id="box_1">
                        <div class="table-responsive">
                          <table class="o_list_table table table-sm table-hover table-striped o_list_table_ungrouped" style="table-layout: fixed;">
                            <thead>
                              <tr>
                                <!-- <th class="o_column_sortable">
                            ID
                            <span class="o_resize" />
                          </th> -->
                                <th class="o_column_sortable">
                                  <strong>Name</strong>
                                  <span class="o_resize" />
                                </th>
                              </tr>
                            </thead>
                            <tbody>
                              <t t-foreach="records" t-as="record">
                                <!-- Record is a Sales Order -->
                                <tr onclick="get_mo_data(this)" t-attf-model_id="{{record.id}}">
                                  <!-- <td t-esc="record.id" /> -->
                                  <td>
                                    <span class="fa fa-caret-right" onclick="toggle_dropdown(this)" style="padding-left: 2px; padding-right: 5px;" />
                                    <span>
                                      <a t-attf-href="#id={{record.id}}&amp;model=sale.order">
                                        <t t-esc="record.name" />
                                      </a>
                                    </span>
                                  </td>
                                  <!-- New Stuff -->
                                  <tr class="dropdown-content">
                                    <td colspan="2" style="padding-left: 10px;">
                                      <table class="o_list_table table table-sm table-hover table-striped o_list_table_ungrouped" style="table-layout: fixed;">
                                        <thead>
                                          <tr>
                                            <th>
                                        Product Name
                                      </th>
                                          </tr>
                                        </thead>
                                        <tbody>
                                          <t t-foreach="record.order_line" t-as="so_line">
                                            <tr>
                                              <!-- <td t-esc="so_line.name" /> -->
                                              <td>
                                                <t t-if="len(so_line.get_mo_records()) > 0">
                                                  <span class="fa fa-caret-right" onclick="toggle_dropdown(this)" style="padding-left: 2px; padding-right: 5px;" />
                                                </t>
                                                <span>
                                                  <a t-attf-href="#id={{so_line.product_id.id}}&amp;model=product.product">
                                                    <t t-esc="so_line.name" />
                                                  </a>
                                                </span>
                                              </td>
                                            </tr>
                                            <!-- Manufacturing Orders -->
                                            <t t-set="mo_lines" t-value="so_line.get_mo_records()" />
                                            <t t-if="mo_lines">
                                              <tr class="dropdown-content">
                                                <td colspan="2" style="padding-left: 10px;">
                                                  <table class="o_list_table table table-sm table-hover table-striped o_list_table_ungrouped" style="table-layout: fixed;">
                                                    <thead>
                                                      <tr>
                                                        <th>
                                                    MO Name
                                                  </th>
                                                      </tr>
                                                    </thead>
                                                    <tbody>
                                                      <t t-foreach="mo_lines" t-as="mo_line">
                                                        <tr>
                                                          <td>
                                                            <a t-attf-href="#id={{mo_line.id}}&amp;model=mrp.production">
                                                              <t t-esc="mo_line.name" />
                                                            </a>
                                                          </td>
                                                        </tr>
                                                      </t>
                                                    </tbody>
                                                  </table>
                                                </td>
                                              </tr>
                                            </t>
                                            <!-- Purchase Orders -->
                                            <t t-if="so_line.purchase_line_ids">
                                              <tr class="dropdown-content">
                                                <td colspan="2" style="padding-left: 10px;">
                                                  <table class="o_list_table table table-sm table-hover table-striped o_list_table_ungrouped" style="table-layout: fixed;">
                                                    <thead>
                                                      <tr>
                                                        <th>
                                                    PO Name
                                                  </th>
                                                      </tr>
                                                    </thead>
                                                    <tbody>
                                                      <t t-foreach="so_line.purchase_line_ids" t-as="purchase_line">
                                                        <tr>
                                                          <!-- <td t-esc="purchase_line.name" /> -->
                                                          <td>
                                                            <span class="fa fa-caret-right" onclick="toggle_dropdown(this)" style="padding-left: 2px; padding-right: 5px;" />
                                                            <span>
                                                              <t t-esc="purchase_line.name" />
                                                            </span>
                                                          </td>
                                                        </tr>
                                                      </t>
                                                    </tbody>
                                                  </table>
                                                </td>
                                              </tr>
                                            </t>
      
                                          </t>
                                        </tbody>
                                      </table>
                                    </td>
                                  </tr>
                                  <!-- Old Stuff -->
      
                                </tr>
                              </t>
                            </tbody>
                          </table>
                        </div>
                      </div>
                      <!-- End Column -->
                    </div>
                    <!-- Box 2 -->
                    <div class="col">
                      <div class="ds_card" id="box_2">
                        <span>Content</span>
                      </div>
                    </div>
                    <!-- End Row -->
                  </div>
                  <div class="row justify-content-around mb-5">
                    <!-- Box 3 -->
                    <div class="col">
                      <div class="ds_card" id="box_3">
                        <span>Content</span>
                      </div>
                    </div>
                    <!-- Box 4 -->
                    <div class="col">
                      <div class="ds_card" id="box_4">
                        <span>Content</span>
                      </div>
                    </div>
                  </div>
                  <!-- End container -->
                </div>
                
                <!-- Collapse all dropdowns -->
                <script>
                  // class target is .dropdown-content
                  $(".dropdown-content").hide();
                </script>
              </qweb>
            </field>
          </record>
    </data>
</odoo>